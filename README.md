# CS2选手信息爬虫 - 优化版本

这是一个用于爬取CS2（Counter-Strike 2）职业选手信息的优化爬虫项目。相比原始版本，这个优化版本提供了更好的错误处理、数据验证、智能请求控制和数据清洗功能。

## 🚀 主要改进

### 1. 代码结构优化
- **模块化设计**: 将功能分离到不同的模块中
- **面向对象**: 使用类来组织代码，提高可维护性
- **配置管理**: 独立的配置文件管理所有设置

### 2. 数据质量提升
- **数据验证**: 严格的输入验证和清洗
- **错误处理**: 完善的异常处理机制
- **数据标准化**: 统一的数据格式和角色映射

### 3. 爬虫性能优化
- **智能请求控制**: 动态调整请求频率
- **会话管理**: 使用Session提高效率
- **用户代理轮换**: 避免被反爬虫机制检测

### 4. 功能增强
- **多数据源**: 支持Liquipedia、HLTV等多个数据源
- **数据去重**: 自动合并和去重选手信息
- **统计报告**: 生成详细的数据统计报告

## 📁 项目结构

```
prodown/
├── optimized_crawler.py    # 主爬虫类
├── data_validator.py       # 数据验证和清洗工具
├── config.py              # 配置文件
├── test_crawler.py        # 测试脚本
├── README.md              # 项目说明
├── requirements.txt       # 依赖包列表
└── output/               # 输出目录
    ├── cs2_players_optimized.csv
    └── statistics_report.txt
```

## 🛠️ 安装和使用

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行爬虫

```bash
python optimized_crawler.py
```

### 3. 运行测试

```bash
python test_crawler.py
```

## 📊 数据字段说明

爬取的选手信息包含以下字段：

| 字段 | 说明 | 示例 |
|------|------|------|
| 姓名 | 选手游戏ID | s1mple |
| 队伍 | 当前所属队伍 | Natus Vincere |
| 国籍 | 选手国籍 | Ukraine |
| 年龄 | 选手年龄 | 28 |
| 游戏内位置 | 在游戏中的角色 | AWPer |
| 数据源 | 数据来源 | Liquipedia |

## 🔧 配置选项

在 `config.py` 中可以调整以下设置：

### 请求控制
- `timeout`: 请求超时时间
- `min_delay`/`max_delay`: 请求间隔
- `dynamic_delay`: 是否启用动态延迟

### 数据验证
- `min_age`/`max_age`: 年龄范围
- `valid_roles`: 有效角色列表
- `valid_nationalities`: 有效国籍列表

### 输出设置
- `output_dir`: 输出目录
- `filename`: 输出文件名
- `generate_report`: 是否生成统计报告

## 📈 数据质量保证

### 验证规则
1. **姓名验证**: 长度2-20字符
2. **年龄验证**: 15-50岁范围
3. **角色验证**: 预定义的有效角色
4. **国籍验证**: 预定义的有效国籍列表

### 数据清洗
1. **文本清理**: 移除HTML标签、Wiki链接
2. **角色标准化**: 统一角色名称
3. **年龄提取**: 从出生日期智能提取年龄
4. **去重处理**: 自动合并重复数据

## 🧪 测试功能

测试脚本包含以下测试项目：

1. **数据验证器测试**: 验证数据验证功能
2. **爬虫基本功能测试**: 测试请求和数据解析
3. **知名选手爬取测试**: 测试特定选手爬取
4. **数据清洗功能测试**: 测试文本清洗和标准化
5. **CSV操作测试**: 测试文件保存功能

## 📋 日志和监控

- **详细日志**: 记录所有操作和错误
- **进度监控**: 实时显示爬取进度
- **错误统计**: 统计和报告错误情况
- **性能监控**: 监控请求频率和响应时间

## 🔍 与原版本对比

| 特性 | 原版本 | 优化版本 |
|------|--------|----------|
| 错误处理 | 基础 | 完善 |
| 数据验证 | 无 | 严格验证 |
| 请求控制 | 简单延迟 | 智能控制 |
| 代码结构 | 脚本式 | 模块化 |
| 配置管理 | 硬编码 | 配置文件 |
| 测试覆盖 | 无 | 完整测试 |
| 日志记录 | 简单打印 | 详细日志 |
| 数据清洗 | 基础 | 全面清洗 |

## 🚨 注意事项

1. **遵守robots.txt**: 请遵守网站的爬虫协议
2. **合理请求频率**: 避免对服务器造成过大压力
3. **数据使用**: 爬取的数据仅供学习和研究使用
4. **网络环境**: 确保网络连接稳定

## 📞 问题反馈

如果遇到问题或有改进建议，请：

1. 查看日志文件了解详细错误信息
2. 运行测试脚本验证功能
3. 检查配置文件设置
4. 确认网络连接和依赖包安装

## 📄 许可证

本项目仅供学习和研究使用，请遵守相关网站的使用条款和robots.txt协议。 